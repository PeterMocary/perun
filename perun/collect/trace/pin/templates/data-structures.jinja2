enum Granularity { G_RTN, G_BBL };
enum AnalysisLocation { L_BEFORE, L_AFTER };
{% if mode in ['time', 'instructions'] %}
enum BasicBlockLocation { BBL_AT_RTN_START, BBL_IN_RTN, BBL_AT_RTN_END };
{% endif -%}

{% if mode in ['time', 'instructions'] -%}
class SourceCodeLocation {
public:
    INT32 line;
    INT32 column;

    std::string fileName;

    SourceCodeLocation(INS instruction);
};
{% endif -%}

{% if mode in ['time', 'instructions'] -%}
class SourceFilesMap {
public:
    std::unordered_map<std::string, UINT32> sourceFiles;
    UINT32 sourceFileIdCounter;

    SourceFilesMap() {
        this->sourceFiles.emplace("", 0);
        this->sourceFileIdCounter = 1;
    }

    UINT32 addFile(std::string file);
    std::string dumpMap();
};
{% endif -%}

{% if collect_functions -%}
class RoutineMetadata {
public:
    ADDRINT address;
    std::string name;
    std::pair<INT32, INT32> locationBoundaries;
    UINT32 sourceCodeFileId;

    RoutineMetadata(RTN routine);
};
{% endif -%}

{% if collect_basic_blocks -%}
class BasicBlockMetadata {
public:
    ADDRINT address;
    std::string routineName;
    UINT32 instructionsCount;
    std::vector<INT32> sourceCodeLines;
    UINT32 sourceCodeFileId;
    BasicBlockLocation locationInRoutine;

    BasicBlockMetadata(BBL basicBlock);
};
{%- endif %}
